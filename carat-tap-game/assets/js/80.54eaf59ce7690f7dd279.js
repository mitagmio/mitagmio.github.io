"use strict";(self.webpackChunkcarat_tap_game=self.webpackChunkcarat_tap_game||[]).push([[80],{8080:(e,n,t)=>{t.r(n),t.d(n,{worker:()=>T});var r=t(1684),i=t(5879),a=t(692);function o(e){return n=this,t=void 0,i=function(){var n;return function(e,n){var t,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(o=0)),o;)try{if(t=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(6===u[0]&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=n.call(e,o)}catch(e){u=[6,e],r=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(t){if(!(null===(n=e.headers.get("Authorization"))||void 0===n?void 0:n.split(" ")[1]))throw new a.c(null,{status:401});return[2]}))},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{c(i.next(e))}catch(e){a(e)}}function u(e){try{c(i.throw(e))}catch(e){a(e)}}function c(n){var t;n.done?e(n.value):(t=n.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}c((i=i.apply(n,t||[])).next())}));var n,t,r,i}var u=t(5684),c=t(8380),l={earned:function(){return c.a.number.int({max:1e6})},id:(0,u.primaryKey)((function(){return c.a.string.uuid()})),image:function(){return c.a.image.urlLoremFlickr({category:"cryptocurrency"})},name:function(){return c.a.company.name()},field:function(){return"crypto"},members:(0,u.manyOf)("member")},s={price:Number,level:Number,type:String,id:(0,u.primaryKey)(String)},d={id:(0,u.primaryKey)((function(){return c.a.string.uuid()})),title:String,reward:Number,link:String},f={id:(0,u.primaryKey)((function(){return c.a.string.uuid()})),currentCompany:(0,u.nullable)((0,u.oneOf)("company")),friends:(0,u.manyOf)("member"),ownerCompanyId:(0,u.nullable)(String)},p={id:(0,u.primaryKey)(String),boosts:(0,u.manyOf)("boost"),capital:function(){return c.a.number.int({max:1e9,min:100})},energy:function(){return c.a.number.int({min:70,max:80})},rank:function(){return"student"}},h={id:(0,u.primaryKey)((function(){return c.a.string.uuid()})),login:function(){return c.a.internet.userName()},image:(0,u.nullable)((function(){return c.a.image.avatar()}))},m=[{title:'Join Channel "Carat"',reward:1e4,link:"https://t.me/carat_official"},{title:'Join Channel "NEWS.TON"',reward:5e3,link:"https://t.me/news_ton"}],v=t(7861),y=[{level:1,price:16e3,type:v.j.multiTap,id:v.j.multiTap},{level:1,price:16e3,type:v.j.rechargingSpeed,id:v.j.rechargingSpeed},{level:1,price:16e3,type:v.j.maxEnergy,id:v.j.maxEnergy},{level:0,price:16e3,type:v.j.autoClicker,id:v.j.autoClicker}],g=t(445),b=t(6874),w=t(2729),k=function(e,n,t,r){return new(t||(t=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function u(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,u)}c((r=r.apply(e,n||[])).next())}))},j=function(e,n){var t,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(o=0)),o;)try{if(t=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){o.label=u[1];break}if(6===u[0]&&o.label<i[1]){o.label=i[1],i=u;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(u);break}i[2]&&o.ops.pop(),o.trys.pop();continue}u=n.call(e,o)}catch(e){u=[6,e],r=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},q=function(e,n,t){if(t||2===arguments.length)for(var r,i=0,a=n.length;i<a;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))},C=function(){var e=(0,u.factory)({boost:s,earn:d,account:f,game:p,member:h,company:l});y.forEach((function(n){return e.boost.create(n)})),m.forEach((function(n){return e.earn.create(n)}));for(var n=0;n<10;n++)e.member.create();var t=e.member.getAll();for(n=0;n<10;n++)e.company.create({members:t});return e.game.create({id:"game",boosts:e.boost.getAll(),capital:1e5}),e}(),S=q([],C.company.toHandlers("rest"),!0),x=[i.L.get("/account",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r,i=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o(i)];case 1:return e.sent(),n=null===(r=i.headers.get("Authorization"))||void 0===r?void 0:r.split(" ")[1],t=C.account.findFirst({where:{id:{equals:n}}}),[2,a.c.json(t)]}}))}))})),i.L.get("/game",(function(e){return k(void 0,[e],void 0,(function(e){var n,t=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o(t)];case 1:return e.sent(),n=C.game.getAll()[0],[2,a.c.json(n)]}}))}))})),i.L.post("/game/sync",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r,i,u,c,l,s,d,f,p=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o(p)];case 1:return e.sent(),[4,p.json()];case 2:return n=e.sent(),(null===(f=p.headers.get("Authorization"))||void 0===f?void 0:f.split(" ")[1])&&(t=C.boost.findFirst({where:{id:{equals:v.j.multiTap}}}),r=C.boost.findFirst({where:{id:{equals:v.j.rechargingSpeed}}}),i=C.boost.findFirst({where:{id:{equals:v.j.rechargingSpeed}}}),u=C.boost.findFirst({where:{id:{equals:v.j.autoClicker}}}),c=C.game.findFirst({where:{id:{equals:"game"}}}),t&&r&&i&&c&&u&&(l=i.level*w.s.energyMultiplier,C.game.update({where:{id:{equals:"game"}},data:{capital:function(e){return e+t.level*n.tap+n[v.Y.autoClick]*u.level},energy:function(e){var i=e-n.tap*t.level+n.regen*r.level;return i>l?l:i}}}))),[4,(0,b.yy)(250)];case 3:return e.sent(),s=C.game.findFirst({where:{id:{equals:"game"}}}),d={energy:null==s?void 0:s.energy,capital:null==s?void 0:s.capital,id:n.id},[2,a.c.json(d)]}}))}))})),i.L.patch("/game/boosts/:id",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r,i,u=e.request,c=e.params;return j(this,(function(e){switch(e.label){case 0:return[4,o(u)];case 1:return e.sent(),n=null===(i=u.headers.get("Authorization"))||void 0===i?void 0:i.split(" ")[1],t=C.boost.findFirst({where:{id:{equals:c.id}}}),n&&t&&(C.boost.update({where:{id:{equals:c.id}},data:{level:function(e){return e+1}}}),C.game.update({where:{id:{equals:"game"}},data:{capital:function(e){return e-(null==t?void 0:t.price)}}})),r=C.boost.findFirst({where:{id:{equals:c.id}}}),[4,(0,b.yy)(250)];case 2:return e.sent(),[2,a.c.json(r)]}}))}))})),i.L.post("/auth",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r,i,o=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o.json()];case 1:return n=e.sent().launchParams,t=(0,g.Wh)(n),(r=t.hash)&&(i=C.company.getAll()[0],C.account.create({currentCompany:i,ownerCompanyId:i.id,friends:C.member.getAll(),id:r})),[2,a.c.json({accessToken:r,refreshToken:"refresh123"})]}}))}))})),i.L.get("/refreshToken",(function(){return k(void 0,void 0,void 0,(function(){return j(this,(function(e){return[2,a.c.json({accessToken:"access123",refreshToken:"refresh123"})]}))}))})),i.L.get("/dictionaries",(function(e){return k(void 0,[e],void 0,(function(e){var n,t=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o(t)];case 1:return e.sent(),n={earnEvents:C.earn.getAll()},[2,a.c.json(n)]}}))}))})),i.L.patch("/companies/:id/leave",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o(r)];case 1:return e.sent(),(n=null===(t=r.headers.get("Authorization"))||void 0===t?void 0:t.split(" ")[1])&&C.account.update({where:{id:{equals:n}},data:{currentCompany:null}}),[2,a.c.json()]}}))}))})),i.L.patch("/companies/:id/join",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r,i=e.request,u=e.params;return j(this,(function(e){switch(e.label){case 0:return[4,o(i)];case 1:return e.sent(),n=null===(r=i.headers.get("Authorization"))||void 0===r?void 0:r.split(" ")[1],t=C.company.findFirst({where:{id:{equals:u.id}}}),n&&C.account.update({where:{id:{equals:n}},data:{currentCompany:t}}),[2,a.c.json(t)]}}))}))})),i.L.post("/companies",(function(e){return k(void 0,[e],void 0,(function(e){var n,t,r,i,u=e.request;return j(this,(function(e){switch(e.label){case 0:return[4,o(u)];case 1:return e.sent(),n=null===(i=u.headers.get("Authorization"))||void 0===i?void 0:i.split(" ")[1],[4,u.json()];case 2:return t=e.sent(),r=C.company.create({name:t.name,earned:0,field:t.field}),n&&C.account.update({where:{id:{equals:n}},data:{currentCompany:r,ownerCompanyId:r.id}}),[2,a.c.json(r)]}}))}))}))],A=q(q([],S.filter((function(e){return"POST"!==e.info.method})),!0),x,!0),T=r.k.apply(void 0,A)}}]);